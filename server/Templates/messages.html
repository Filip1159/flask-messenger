{% extends "base.html" %}
{% block styles %}
<link rel="stylesheet" href="/static/css/leftpanel.css"/>
<link rel="stylesheet" href="/static/css/search.css"/>
<link rel="stylesheet" href="/static/css/messages.css"/>
<link rel="stylesheet" href="/static/css/newmessageinput.css"/>
<link rel="stylesheet" href="/static/css/seenavatar.css"/>
<link rel="stylesheet" href="/static/css/rightpanel.css"/>
{% endblock %}

{% block body %}
<div class="app__container">
    <div class="leftPanel">
        <div class="leftPanel__flipped">
            <div class="search">
                <img class="search__img" src="/static/search.png" alt="search"/>
                <div class="search__container">
                    Szukaj:
                    <input type="text" class="search__queryInput"/>
                    <div class="search__queryResult">
                        <ul>
                            <li>{`${u.name} ${u.surname}`}</li>
                        </ul>
                    </div>
                </div>
            </div>
            {% for chat in chats %}
                <a href={{"/chats/" ~ chat.id}}>
                    <div class="chatItem">
                        <img src={{"/static/avatars/" ~ chat.second_user.username ~ ".png"}} alt="User avatar"/>
                        <div class="chatItem__chatData">
                            <span class="chatItem__chatData__nameSurname">{{chat.name_surname}}</span>
                            <span class="chatItem__chatData__lastMessage">{{chat.description}}</span>
                        </div>
                    </div>
                </a>
            {% endfor %}
            <div class="leftPanel__foo"></div>
        </div>
    </div>
    <div class="messages">
        <div class="messages__container">
            {% for message in messages %}
                {% if message.my == True %}
                    <div class="messages__singleMessage messages__singleMessage--myMsg">
                        {{message.content}}
                        <div class="messages__singleMessage__tooltip">{{message.time}}</div>
                    </div>
                {% else %}
                    <div class="messages__singleMessage messages__singleMessage--receivedMsg">
                        {{message.content}}
                        <div class="messages__singleMessage__tooltip">{{message.time}}</div>
                    </div>
                {% endif %}
                {% if message.read_by_second_user == True %}
                    <img class="seenAvatar"
                        src={{"/static/avatars/" ~ messages.username ~ ".png" }}
                        alt="seen avatar"
                    />
                {% endif %}
            {% endfor %}
        </div>
        <div class="newMessageInput">
            <input type="text" class="newMessageInput__input"/>
            <input type="image" class="newMessageInput__btn" src="/static/send.png" alt="Send"/>
        </div>
    </div>
    <div class="rightPanel">
        <img
            src={{"/static/avatars/" ~ user_details.username ~ ".png"}}
            alt="User avatar"
            class="rightPanel__userAvatar"
        />
        <span class="rightPanel__nameSurname">{{user_details.name_surname}}</span>
        <span class="rightPanel__username">{{user_details.username}}</span>
    </div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js" integrity="sha512-q/dWJ3kcmjBLU4Qc47E4A9kTB4m3wuTY7vkFJDTZKjTs8jhyGQnaUrxa0Ytd0ssMZhbNua9hE+E7Qv1j+DyZwA==" crossorigin="anonymous"></script>
<script type="text/javascript" src="{{ url_for('static', filename='js/utils.js') }}"></script>
{% endblock %}